# 送信コマンド仕様

Firmware Version 2.3について記述

通信速度は115200bps 改行文字はCRLFが規定  
ターミナルソフトやAD7SGPR シリアル通信Webアプリより送信してください。

# 目次

- [送信コマンド仕様](#送信コマンド仕様)
- [目次](#目次)
- [送信コマンド一覧](#送信コマンド一覧)
- [各コマンド詳細仕様](#各コマンド詳細仕様)
  - [英数字・記号(ASCII)](#英数字記号ascii)
  - [@HEX](#hex)
  - [@CLR](#clr)
  - [@ANI](#ani)
  - [@7SG](#7sg)
  - [セグメントの個別制御について](#セグメントの個別制御について)
  - [エラーコード内容](#エラーコード内容)


# 送信コマンド一覧
コマンドを送信する際は余計なスペースなどを含めないでください。  
連続でデータを送信する場合は最低1ms以上の間隔を空けてください。  
確実に行うのであればAD7SGPRからのアンサーバックを確認してからの送信をおすすめします。

| コード | 機能 |
| --- | --- |
| 英数字・記号(ASCII) | 受信した英数字・記号を7セグディスプレイに表示します。(最大8桁まで、「.」は1つまで)              |
| @HEX[??*8桁]        | 16進数のデータでセグメントを個別に制御します。 |
| @CLR                | ディスプレイをクリアします。                                                                    |
| @ANI[数字0-2]       | ディスプレイのトランジションを設定します。<br>@ANI0 アニメなし<br>@ANI1 数字によるスロット風<br>@ANI2 セグメントの回転 |
| @7SG[数字0,1]       | ディスプレイの表示モードを設定します。<br>@7SG0 ディスプレイ消灯<br>@7SG1 ディスプレイ点灯<br>7セグの表示はされないだけでAD7SGPRから応答は返ってきます |
| @BRI[数字0-7]       | ディスプレイの輝度を設定します。@BRI の後に 0 から 7 の数字をつけて輝度を設定します。例：@BRI5     |
| @BRR                | 現在のディスプレイの輝度を返します。                                                            |


---

# 各コマンド詳細仕様

## 英数字・記号(ASCII)

AD7SGPRに送信した文字列を7セグメントディスプレイに表示する  
(8桁まで、小数点は1つまで)  

| 送信コード | AD7SGPR返信コード| AD7SGPR表示  | 概要 |
| --- | --- | --: | --- |
| 123 | rxData:123| 123 |数字表示|
| abc | rxData:abc | abc |英字表示(一部英字・記号は不完全な状態で描画されます)|
| bto2023 | rxData:bto2023 | bto2023 |英数混合表示|
| 123456789 | rxData:123456789 | 23456789 |表示は8桁まで|
---
## @HEX
セグメントの個別点灯の制御
字では表せないようなセグメントの点灯をサポート

| 送信コード | AD7SGPR返信コード| AD7SGPR表示  | 概要 |
| --- | --- | --: | --- |
| @HEXFFFFFFFFFFFFFFFF | rxData:@HEXFFFFFFFFFFFFFFFF | 8.8.8.8.8.8.8.8. |  |
| @HEX0000000000000080 |rxData:@HEX0000000000000080 |       .| |
| @HEXFF00000000000000| rxData:@HEXFF00000000000000 | 8.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;||
|@HEX|rxData:@HEX<br>E3: Need 16 hex digits||@HEXのあとに続く文字が16桁ではない|

### @HEXコマンドの個別制御について解説

![セグメント割当](https://github.com/bit-trade-one/AD7SGPR-SCWA/assets/85532743/ef28a74a-37e0-4872-a17f-20ae382e3b21)

| @HEX用16進数 | セグメント点灯       |
| ------------ | -------------------- |
| 00           | (無点灯)             |
| 01           | a                    |
| 02           | b                    |
| 03           | a, b                 |
| 04           | c                    |
| 05           | a, c                 |
| 06           | b, c                 |
| 07           | a, b, c              |
| 08           | d                    |
| 09           | a, d                 |
| 0A           | b, d                 |
| 0B           | a, b, d              |
| 0C           | c, d                 |
| 0D           | a, c, d              |
| 0E           | b, c, d              |
| 0F           | a, b, c, d           |
| 10           | e                    |
| ...          | ...                  |
| 7F           | a, b, c, d, e, g     |
| 80           | D.P (decimal point)   |
| 81           | a, D.P                |
| 82           | b, D.P                |
| 83           | a, b, D.P             |
| 84           | c, D.P                |
| ...          | ...                  |
| FE           | a, b, c, d, e, g, D.P |
| FF           | a, b, c, d, e, f, g, D.P |


---

## @CLR

７セグメントディスプレイに表示された内容を消去する

| 送信コード | AD7SGPR返信コード| AD7SGPR表示  | 概要 |
| --- | --- | --: | --- |
|@CLR|rxData:@CLR Display clear|(消去)||


---

## @ANI
トランジション（表示遷移時のアニメーション）の設定  

| 送信コード | AD7SGPR返信コード| AD7SGPR表示  | 概要 |
| --- | --- | --: | --- |
|@ANI0|rxData:@ANI0<br>No animation||トランジションをなしに設定(デフォルト)|
|@ANI1|rxData:@ANI1<br>Animation1||トランジションをパターン1に設定(数字によるスロット風)|
|@ANI2|rxData:@ANI2<br>Animation2||トランジションをパターン2に設定(セグメントの回転)|


---

## @7SG
7セグメントディスプレイの表示モードを設定する

| 送信コード | AD7SGPR返信コード| AD7SGPR表示  | 概要 |
| --- | --- | --: | --- |
| @7SG0 | rxData:@7SG0<br>7sgOff | (裏面LED弱く点灯) | | 
| @7SG1 | rxData:@7SG1<br>7sgOn | (裏面LED強く点灯) | |















## エラーコード一覧

| エラーコード | エラー内容                                                        |
| ------------ | ----------------------------------------------------------------- |
| E0           | Over receive length<br>受信文字は20文字未満にしてください         |
| E1           | Multiple dots<br>ピリオドを1個以上存在させないでください           |
| E2           | Over 8 length<br>8文字を超えてしまっているので表示できない       |
| E3           | Need 16 hex digits<br>16桁の16進数が必要                          |
| E4           | Brightness out of range<br>輝度が範囲外                           |
